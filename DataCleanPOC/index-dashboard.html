<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Esiti & Classi – Sostenibilità</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3"></script>
  <style>
    :root{
      --acqua: #20c5bd;
      --bg:#f7fafc;         /* sfondo pagina */
      --card:#ffffff;        /* sfondo card */
      --ink:#0f172a;         /* testo primario */
      --muted:#475569;       /* testo secondario */
      --border:#e2e8f0;      /* bordo */
      --brand1:#6366f1;      /* indigo */
      --brand2:#06b6d4;      /* cyan */
      --good:#10b981;        /* emerald */
      --warn:#f59e0b;        /* amber */
      --bad:#ef4444;         /* red */
      --pue:#6366f1;         /* colori sezione */
      --wue:#0ea5e9;
      --cue:#10b981;
      --sci:#a21caf;         /* fuchsia-700 */
      --radius:16px;
      --shadow:0 6px 20px rgba(2,6,23,0.08);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(140deg,#ffffff, #448aaa 40%, #ffffff);color:var(--ink)}
    
    .container{
      max-width: 1180px;
      margin: 0 auto;
      padding: 205px 20px 32px 20px;
    }
    
    h1{font-size:clamp(24px,3vw,34px);margin:0 0 6px 0}
    
    .lead{color:var(--muted);font-size:15px;max-width:900px}

    /* ====== HEADER ====== */
    header{
      padding:16px 16px 14px;
      border-bottom:4px solid var(--acqua);
      background:#fff;
      position: fixed;
      width: 100%;
      z-index: 1;
    }
    .header-wrap{
      display:flex; align-items:center; gap:12px; flex-wrap:wrap; justify-content:space-between;
    }
    /* Header actions */
    .actions{ display:flex; align-items:center; gap:10px; margin-left:auto; }
    .icon-btn{ position:relative; border:1px solid var(--border); background:#ffffff; color:#0f172a; border-radius:10px; padding:8px 10px; cursor:pointer; box-shadow:0 2px 8px rgba(2,6,23,0.06); transition:background .15s ease, transform .05s ease; }
    .icon-btn:hover{ background:#f8fafc; }
    .icon-btn:active{ transform:translateY(1px); }
    .icon-btn svg{ width:20px; height:20px; display:block; }
    .notif-badge{ position:absolute; top:-6px; right:-6px; background:#ef4444; color:#fff; border-radius:999px; font-size:11px; line-height:1; padding:2px 6px; border:2px solid #fff; display:inline-flex; align-items:center; justify-content:center; min-width:18px; }
    .print-btn{ display:inline-flex; align-items:center; gap:8px; font-weight:600; }
    .print-btn span{ font-size:13px; }
    @media(max-width:520px){ .print-btn span{ display:none; } }
    .brand{
      display:flex; align-items:center; gap:10px;
    }
    .brand img{
      height:180px; width:auto; object-fit:contain;
      image-rendering:auto;
    }
    @media(min-width:720px){
      .brand img{ height:180px; }
    }
    .title{font-weight:800; letter-spacing:.2px; font-size:1.45rem}
    .subtitle{color:var(--muted); font-size:.95rem}

    /* Section */
    .section{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px 20px 24px 20px;margin-top:22px;box-shadow:var(--shadow)}
    .section-header{display:flex;gap:16px;align-items:flex-start;justify-content:space-between}
    .dot{width:10px;height:10px;border-radius:999px;flex:0 0 auto;margin-top:10px}
    .title{font-weight:700;font-size:22px;margin:0}
    .desc{color:var(--muted);font-size:14px;margin:6px 0 0 0;max-width:720px}

    .grid{display:grid;grid-template-columns:1fr;gap:16px;margin-top:16px}
    @media (min-width: 980px){.grid{grid-template-columns:1fr 1fr 1fr}}

    /* Card KPI */
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px}
    .band{height:6px;border-radius:6px;background:linear-gradient(90deg,#16a34a,#84cc16,#f59e0b,#f97316,#ef4444);opacity:.85;margin:-16px -16px 12px -16px}
    .muted{color:var(--muted);font-size:12px}
    .kpi-title{font-size:18px;margin:0 0 2px 0}
    .kpi-value{font-size:28px;font-weight:800}
    .kpi-unit{color:var(--muted);margin-left:6px;font-size:14px}

    /* Placeholder grafico e immagine */
    .chart-area,.image-ph{height:170px;border:1px dashed var(--border);border-radius:12px;background:linear-gradient(140deg,#f0f9ff,#ffffff);display:flex;align-items:center;justify-content:center;color:#64748b;font-size:13px}

    /* Badge classe */
    .badge{display:inline-flex;align-items:center;gap:8px;border-radius:999px;border:1px solid var(--border);padding:8px 12px;font-weight:700;font-size:14px;width: 150px;justify-content: center;}
    .A{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
    .B{background:#f7fee7;color:#365314;border-color:#d9f99d}
    .C{background:#fffbeb;color:#92400e;border-color:#fde68a}
    .D{background:#fff7ed;color:#9a3412;border-color:#fed7aa}
    .E{background:#fef2f2;color:#7f1d1d;border-color:#fecaca}

    /* Allarmi */
    .alarms{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin-top:26px;box-shadow:var(--shadow)}
    table{width:100%;border-collapse:separate;border-spacing:0}
    th,td{padding:12px 10px;text-align:left;border-bottom:1px solid var(--border);font-size:14px}
    th{background:#f8fafc;color:#475569;font-weight:600}
    .state{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:600;font-size:12px;border:1px solid}
    .ok{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
    .warn{background:#fffbeb;color:#92400e;border-color:#fde68a}
    .alert{background:#fef2f2;color:#7f1d1d;border-color:#fecaca}
    .note{color:var(--muted);font-size:12px;margin-top:8px}

    .hint{font-size:12px;color:var(--muted)}

    /* Chat/news widgets */
    .chat-box { border: 1px solid var(--border); border-radius: 12px; background: #f8fafc; display: flex; flex-direction: column; height: 170px; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
    .chat-title { background: #e2e8f0; font-weight: 600; font-size: 13px; color: #1e293b; padding: 6px 10px; }
    .chat-messages { padding: 8px 10px; font-size: 13px; line-height: 1.4; overflow-y: auto; }
    .chat-message { margin-bottom: 6px; border-left: 3px solid var(--border); padding-left: 8px; }
    .chat-message strong { color: #0f172a; }
    .chat-message time { color: #64748b; font-size: 11px; margin-left: 4px; }
    
    /* ====== PRINT STYLES ====== */
    @media print {
      @page { size: A4; margin: 12mm 12mm 14mm 12mm; }
      html, body { background: #fff !important; }
      header { display: none !important; }
      .container { padding: 0 !important; margin: 0 auto !important; max-width: none !important; }

      /* Cards & sections: no shadows, tighter spacing, avoid breaks inside */
      .section { box-shadow: none !important; border-color: #bbbbbb !important; margin: 10mm 0 8mm !important; break-inside: avoid; page-break-inside: avoid; }
      .grid { gap: 10px !important; }
      .card { box-shadow: none !important; border-color: #cccccc !important; break-inside: avoid; page-break-inside: avoid; }

      /* Tables: clearer headers in grayscale */
      table { font-size: 12px; }
      th { background: #eaeaea !important; color: #111 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }

      /* Badges & bands: keep visible but subtle */
      .badge { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .band { opacity: 0.6 !important; }

      /* Hints and borders slightly darker */
      .hint, .note { color: #444 !important; }
      .chart-area, .chat-box { border-color: #dddddd !important; }

      /* Remove page background gradients */
      body { background-image: none !important; }
    }
  </style>
  
</head>
<body>
  <header>
    <div class="header-wrap">
      <div class="brand">
        <img src="img/logo-sfondo-bianco-verticale.png" alt="Dataclean logo" />
        <div>
          <div class="title">Scheda di sostenibilità ICT</div>
          <div class="subtitle">Indicatori PUE · WUE · CUE · SCI — Emissioni da AWS</div>
        </div>
      </div>
      <div class="actions">
        <button class="icon-btn print-btn" id="btnPrint" aria-label="Stampa report" title="Stampa report">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <polyline points="6 9 6 2 18 2 18 9"></polyline>
            <path d="M6 18H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2h-2"></path>
            <rect x="6" y="14" width="12" height="8"></rect>
          </svg>
          <span>Stampa</span>
        </button>
        <button class="icon-btn" id="btnBell" aria-label="Notifiche" title="Notifiche">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M18 8a6 6 0 0 0-12 0c0 7-3 8-3 8h18s-3-1-3-8"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
          <span class="notif-badge" id="notifBadge">0</span>
        </button>
      </div>
    </div>
  </header>
  <div class="container">
    <!-- PUE -->
    <section id="sec-pue" class="section" aria-labelledby="pue-title">
      <div class="section-header">
        <div>
          <h2 id="pue-title" class="title" style="color:var(--pue);">PUE – Power Usage Effectiveness</h2>
          <p class="desc">Efficienza energetica complessiva.</p>
        </div>
        <span id="pue-badge" class="badge">Classe –</span>
      </div>
      <div class="grid">
        <article class="card">
          <div class="band"></div>
          <div class="muted">Esito</div>
          <h3 class="kpi-title">Valore attuale</h3>
          <div><span id="pue-val" class="kpi-value">—</span><span class="kpi-unit"></span></div>
          <p class="hint">Minore è meglio • Classi A–E</p>
        </article>
        <article class="card">
          <div class="muted">Trend PUE</div>
          <div class="chart-area">
            <canvas id="chartPUE"></canvas>
          </div>
          <p class="hint">Andamento delle ultime 7 esecuzioni del report</p>
        </article>
        <article class="card">
          <div class="chat-box" id="chatPUE">
            <div class="chat-title">📰 News &amp; Aggiornamenti PUE</div>
            <div class="chat-messages"></div>
          </div>
        </article>
      </div>
    </section>

    <!-- WUE -->
    <section id="sec-wue" class="section" aria-labelledby="wue-title">
      <div class="section-header">
        <div>
          <h2 id="wue-title" class="title" style="color:var(--wue);">WUE – Water Usage Effectiveness</h2>
          <p class="desc">Consumo d'acqua per energia (m³/MWh).</p>
        </div>
        <span id="wue-badge" class="badge">Classe –</span>
      </div>
      <div class="grid">
        <article class="card">
          <div class="band"></div>
          <div class="muted">Esito</div>
          <h3 class="kpi-title">Valore attuale</h3>
          <div><span id="wue-val" class="kpi-value">—</span><span class="kpi-unit"> m³/MWh</span></div>
          <p class="hint">Minore è meglio • Classi A–E</p>
        </article>
        <article class="card">
          <div class="muted">Trend WUE</div>
          <div class="chart-area">
            <canvas id="chartWUE"></canvas>
          </div>
          <p class="hint">Andamento delle ultime 7 esecuzioni del report</p>
        </article>
        <article class="card">
          <div class="chat-box" id="chatWUE">
            <div class="chat-title">📰 News &amp; Aggiornamenti WUE</div>
            <div class="chat-messages"></div>
          </div>
        </article>
      </div>
    </section>

    <!-- CUE -->
    <section id="sec-cue" class="section" aria-labelledby="cue-title">
      <div class="section-header">
        <div>
          <h2 id="cue-title" class="title" style="color:var(--cue);">CUE – Carbon Usage Effectiveness</h2>
          <p class="desc">Emissioni per kWh IT (kgCO₂e/kWh IT).</p>
        </div>
        <span id="cue-badge" class="badge">Classe –</span>
      </div>
      <div class="grid">
        <article class="card">
          <div class="band"></div>
          <div class="muted">Esito</div>
          <h3 class="kpi-title">Valore attuale</h3>
          <div><span id="cue-val" class="kpi-value">—</span><span class="kpi-unit"> kgCO₂e/kWh</span></div>
          <p class="hint">Minore è meglio • Classi A–E</p>
        </article>
        <article class="card">
          <div class="muted">Trend CUE</div>
          <div class="chart-area">
            <canvas id="chartCUE"></canvas>
          </div>
          <p class="hint">Andamento delle ultime 7 esecuzioni del report</p>
        </article>
        <article class="card">
          <div class="chat-box" id="chatCUE">
            <div class="chat-title">📰 News &amp; Aggiornamenti CUE</div>
            <div class="chat-messages"></div>
          </div>
        </article>
      </div>
    </section>

    <!-- SCI -->
    <section id="sec-sci" class="section" aria-labelledby="sci-title">
      <div class="section-header">
        <div>
          <h2 id="sci-title" class="title" style="color:var(--sci);">SCI – Software Carbon Intensity</h2>
          <p class="desc">Emissioni per richiesta API (gCO₂e per richiesta).</p>
        </div>
        <span id="sci-badge" class="badge">Classe –</span>
      </div>
      <div class="grid">
        <article class="card">
          <div class="band"></div>
          <div class="muted">Esito</div>
          <h3 class="kpi-title">Valore attuale</h3>
          <div><span id="sci-val" class="kpi-value">—</span><span class="kpi-unit"> gCO₂e/richiesta</span></div>
          <p class="hint">Minore è meglio • Classi A–E</p>
        </article>
        <article class="card">
          <div class="muted">Trend SCI</div>
          <div class="chart-area">
            <canvas id="chartSCI"></canvas>
          </div>
          <p class="hint">Andamento delle ultime 7 esecuzioni del report</p>
        </article>
        <article class="card">
          <div class="chat-box" id="chatSCI">
            <div class="chat-title">📰 News &amp; Aggiornamenti SCI</div>
            <div class="chat-messages"></div>
          </div>
        </article>
      </div>
    </section>

    <!-- Pannello Allarmi -->
    <section class="alarms" aria-labelledby="alarms-title">
      <h2 id="alarms-title" style="margin:0 0 6px 0">Allarmi & Realtime</h2>
      <div class="hint">*Valori e soglie mock – personalizzare per il certificato realtime*</div>
      <div style="overflow:auto;margin-top:10px">
        <table id="alarm-table" aria-describedby="alarms-title">
          <thead>
            <tr>
              <th>Indicatore</th>
              <th>Valore</th>
              <th>Soglia allarme</th>
              <th>Stato</th>
              <th>Nota</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p class="note">Allarme se <b>valore &gt; soglia</b>. "Attenzione" entro il 5% dalla soglia.</p>
    </section>
  </div>

  <script>
    // -----------------------------
    // Valori MOCK – modificabili
    // -----------------------------
    if (window['chartjs-plugin-annotation']) { Chart.register(window['chartjs-plugin-annotation']); }
    const VALUES = {
      PUE: 1.32,      
      WUE: 0.78,      // m³/MWh
      CUE: 0.21,      // kgCO2e/kWh IT
      SCI: 12.5       // gCO2e per richiesta API
    };

    // Soglie mock per allarmi (personalizza)
    const THRESHOLDS = {
      PUE: 1.4,
      WUE: 0.8,
      CUE: 0.25,
      SCI: 15
    };

    // Bande di classe A–E per ogni indicatore (limiti superiori per A-D)
    const CLASS_BANDS = {
      PUE: [1.2, 1.4, 1.6, 1.8],
      WUE: [0.6, 0.8, 1.0, 1.2],
      CUE: [0.15, 0.20, 0.25, 0.30],
      SCI: [8, 12, 16, 20]
    };

    function valutaClasse(v, bands){
      if (v <= bands[0]) return 'A';
      if (v <= bands[1]) return 'B';
      if (v <= bands[2]) return 'C';
      if (v <= bands[3]) return 'D';
      return 'E';
    }

    function setBadge(el, classe){
      el.className = 'badge ' + classe; // sostituisce e applica stile
      el.textContent = 'Classe ' + classe;
    }

    // Popola sezioni
    document.getElementById('pue-val').textContent = VALUES.PUE.toFixed(2);
    setBadge(document.getElementById('pue-badge'), valutaClasse(VALUES.PUE, CLASS_BANDS.PUE));

    document.getElementById('wue-val').textContent = VALUES.WUE.toFixed(2);
    setBadge(document.getElementById('wue-badge'), valutaClasse(VALUES.WUE, CLASS_BANDS.WUE));

    document.getElementById('cue-val').textContent = VALUES.CUE.toFixed(2);
    setBadge(document.getElementById('cue-badge'), valutaClasse(VALUES.CUE, CLASS_BANDS.CUE));

    document.getElementById('sci-val').textContent = VALUES.SCI.toFixed(1);
    setBadge(document.getElementById('sci-badge'), valutaClasse(VALUES.SCI, CLASS_BANDS.SCI));

    // Pannello Allarmi
    const tbody = document.querySelector('#alarm-table tbody');
    const rows = [
      {key:'PUE', label:'PUE'},
      {key:'WUE', label:'WUE (m³/MWh)'},
      {key:'CUE', label:'CUE (kgCO₂e/kWh IT)'},
      {key:'SCI', label:'SCI (gCO₂e/richiesta)'}
    ];

    rows.forEach(r => {
      const v = VALUES[r.key];
      const th = THRESHOLDS[r.key];
      const delta = v - th; // minore è meglio → allarme se v > th
      let state = 'ok', note = 'Entro i limiti.';
      if (delta > 0) { state = 'alert'; note = 'Soglia superata: intervento richiesto.'; }
      else if (Math.abs(delta) <= th * 0.05) { state = 'warn'; note = 'Vicino alla soglia: valuta azioni correttive.'; }

      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${r.label}</td>
        <td>${v}</td>
        <td>${th}</td>
        <td><span class="state ${state}">${state === 'ok' ? 'OK' : (state === 'warn' ? 'Attenzione' : 'Allarme')}</span></td>
        <td>${note}</td>
      `;
      tbody.appendChild(tr);
    });
    // Aggiorna badge notifiche (warn + alert)
    const numAlerts = document.querySelectorAll('.state.alert').length;
    const numWarns = document.querySelectorAll('.state.warn').length;
    const totalNotif = numAlerts + numWarns;
    const badgeEl = document.getElementById('notifBadge');
    if (badgeEl){
      badgeEl.textContent = String(totalNotif);
      badgeEl.style.display = totalNotif > 0 ? 'inline-flex' : 'none';
    }

    // -----------------------------
    // Grafici indici
    // -----------------------------
// Etichette temporali comuni (mock)
    const LABELS = ["T-6","T-5","T-4","T-3","T-2","T-1","Now"];

    // Dati mock per ciascun indicatore (sostituisci liberamente)
    const DATASETS = {
      PUE: [1.36, 1.33, 1.31, 1.30, 1.29, 1.28, 1.27],
      WUE: [0.92, 0.86, 0.83, 0.82, 0.80, 0.79, 0.78],
      CUE: [0.27, 0.24, 0.23, 0.23, 0.22, 0.22, 0.21],
      SCI: [18.5, 16.9, 15.1, 14.3, 13.6, 12.9, 12.3]
    };

    // Colori coerenti
    const COLORS = {
      PUE: "#6366f1", // indigo
      WUE: "#0ea5e9", // sky
      CUE: "#10b981", // emerald
      SCI: "#a21caf"  // fuchsia-700
    };

    // Helper per creare un grafico lineare con soglia (linea orizzontale)
    function makeLineChart(canvasId, label, color, data, yTitle, threshold) {
      const ctx = document.getElementById(canvasId).getContext("2d");
      return new Chart(ctx, {
        type: "line",
        data: {
          labels: LABELS,
          datasets: [{
            label,
            data,
            borderColor: color,
            backgroundColor: color + "20",
            borderWidth: 2,
            fill: true,
            tension: 0.35,
            pointRadius: 3,
            pointBackgroundColor: color
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            title: { display: false },
            annotation: {
              annotations: {
                threshold: {
                  type: 'line',
                  yMin: threshold,
                  yMax: threshold,
                  borderColor: '#ef4444',
                  borderWidth: 2,
                  borderDash: [6, 6],
                  label: {
                    display: true,
                    content: 'Soglia ' + threshold,
                    position: 'start',
                    backgroundColor: 'rgba(239,68,68,0.1)',
                    color: '#991b1b',
                    padding: 4
                  }
                }
              }
            }
          },
          interaction: { mode: "index", intersect: false },
          scales: {
            x: {
              grid: { display: false },
              title: { display: false }
            },
            y: {
              grid: { color: "#eef2f7" },
              ticks: { precision: 2 },
              title: { display: !!yTitle, text: yTitle }
            }
          }
        }
      });
    }

    // Istanzia i 4 grafici
    makeLineChart("chartPUE", "PUE", COLORS.PUE, DATASETS.PUE, "Valore PUE", THRESHOLDS.PUE);
    makeLineChart("chartWUE", "WUE", COLORS.WUE, DATASETS.WUE, "m³/MWh", THRESHOLDS.WUE);
    makeLineChart("chartCUE", "CUE", COLORS.CUE, DATASETS.CUE, "kgCO₂e/kWh IT", THRESHOLDS.CUE);
    makeLineChart("chartSCI", "SCI", COLORS.SCI, DATASETS.SCI, "gCO₂e / richiesta", THRESHOLDS.SCI);


    // -----------------------------
    // Chat/news mock per ogni indice
    // -----------------------------
    const NEWS = {
      PUE: [
        { title: "Nuovo record: data center raggiunge PUE 1.12", date: "2025-10-28" },
        { title: "Ottimizzazione UPS: -2% perdite distribuzione", date: "2025-10-27" },
        { title: "Free cooling esteso riduce i consumi del 5%", date: "2025-10-25" },
        { title: "Containment corridoi caldi completato nel pod B", date: "2025-10-23" },
        { title: "Audit energetico trimestrale: PUE medio 1.29", date: "2025-10-18" }
      ],
      WUE: [
        { title: "Riciclo acque grigie: risparmio stimato 18%", date: "2025-10-27" },
        { title: "Nuovi filtri torri evaporative installati", date: "2025-10-24" },
        { title: "DC in area arida introduce WUE a 0.67 m³/MWh", date: "2025-10-20" }
      ],
      CUE: [
        { title: "Nuovo PPA solare: CUE stimato < 0.20 kgCO₂e/kWh", date: "2025-10-29" },
        { title: "Switch notturno su fasce a bassa intensità carbonica", date: "2025-10-28" },
        { title: "Emissioni dei DC europei in calo del 7% nel 2025", date: "2025-10-22" },
        { title: "Batterie caricate con surplus eolico (pilot)", date: "2025-10-19" },
        { title: "Report mensile: fattore di emissione medio 268 g/kWh", date: "2025-10-17" },
        { title: "Certificazione GoO aggiornata per Q4", date: "2025-10-15" }
      ],
      SCI: [
        { title: "Benchmark: API serverless SCI medio 9 gCO₂e/richiesta", date: "2025-10-26" },
        { title: "Caching CDN porta -12% di emissioni per richiesta", date: "2025-10-24" },
        { title: "Ottimizzazione query DB riduce emissioni del 18%", date: "2025-10-21" },
        { title: "Autoscaling più aggressivo nelle ore notturne", date: "2025-10-19" }
      ]
    };

    function populateChat(id, list) {
      const box = document.querySelector(`#chat${id} .chat-messages`);
      if (!box) return;
      box.innerHTML = "";
      list.forEach(n => {
        const div = document.createElement("div");
        div.className = "chat-message";
        div.innerHTML = `<strong>${n.title}</strong> <time>${n.date}</time>`;
        box.appendChild(div);
      });
    }

    ["PUE", "WUE", "CUE", "SCI"].forEach(k => populateChat(k, NEWS[k]));

    // Azioni header: stampa e navigazione notifiche
    const btnPrint = document.getElementById('btnPrint');
    if (btnPrint) btnPrint.addEventListener('click', () => window.print());

    const btnBell = document.getElementById('btnBell');
    if (btnBell) btnBell.addEventListener('click', () => {
      const target = document.getElementById('alarms-title');
      if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  </script>
</body>
</html>
